# Prototype Design Pattern in Vim9script

## Overview

The **Prototype Pattern** is a creational design pattern that creates new objects by cloning existing ones, avoiding direct dependencies on concrete classes.

## Intent

- Clone objects without coupling to concrete types
- Reduce expensive creation work
- Allow runtime configuration of prototypes

## Also Known As

- None

## When to Use

Use the Prototype pattern when:
- Object creation is expensive or complex
- You want to reduce subclassing for variations
- You need to create similar objects at runtime

## Structure

```
Client -> Prototype
PrototypeRegistry -> Prototype
```

## Participants

1. **Prototype**: Declares the clone operation (`Shape`)
2. **Concrete Prototypes**: Implement cloning (`Circle`, `Rectangle`, `ComplexShape`)
3. **Registry**: Stores and returns clones (`ShapeRegistry`)
4. **Client**: Requests clones from prototypes

## Implementation in Vim9script

The example uses Vim9 abstract classes and per-type clone methods:

```vim
abstract class Shape
  abstract def Clone(): Shape
endclass
```

## Examples Included

### 1. Shape Cloning System
**Scenario**: Clone shapes from a registry and customize their state.

**Components**:
- Prototypes: `Circle`, `Rectangle`, `Triangle`, `ComplexShape`
- Registry: `ShapeRegistry`

**Usage**:
```vim
var registry = ShapeRegistry.new()
registry.AddPrototype('red-circle', Circle.new('proto-1', 0, 0, 'red', 10))
var circle = registry.GetPrototype('red-circle')
```

## Running the Examples

### Source the file
```vim
:source prototype_pattern.vim
```

### Run the main demo
```vim
:call g:RunPrototypePatternDemo()
```

### Run the deep copy demo
```vim
:call g:RunDeepCopyDemo()
```

## Key Concepts Demonstrated

1. **Cloning** via per-type `Clone()` implementations
2. **Registry Use** to manage available prototypes
3. **Deep Copy** for nested object graphs

## Advantages

1. **Performance**: Cloning can be faster than new construction
2. **Flexibility**: Add or remove prototypes at runtime
3. **Encapsulation**: Creation logic stays with the prototype

## Disadvantages

1. **Clone Complexity**: Deep copies can be tricky
2. **Initialization**: Prototypes must be configured carefully

## Related Patterns

- **Factory Method**: Creates objects via subclasses
- **Abstract Factory**: Creates related object families
- **Builder**: Constructs complex objects step by step

## Vim9script Notes

- Abstract classes define the clone contract
- Type annotations clarify clone return types
- Global demo functions provide easy entry points

## Requirements

- Vim 9.0 or later (for Vim9script class support)
- No external dependencies

## License

MIT License - Feel free to use this for learning and teaching design patterns!

## Credits

These design pattern examples were generated by GitHub Copilot to demonstrate modern Vim9script capabilities and software design principles.

## References

For more information about the Prototype pattern, visit:

- **Refactoring.Guru**: [Prototype Pattern](https://refactoring.guru/design-patterns/prototype)
- **Gang of Four Book**: "Design Patterns: Elements of Reusable Object-Oriented Software" by Gamma, Helm, Johnson, Vlissides - Pages 117-126
- **Wikipedia**: [Prototype Pattern](https://en.wikipedia.org/wiki/Prototype_pattern)
- **SourceMaking**: [Prototype Design Pattern](https://sourcemaking.com/design_patterns/prototype)

## Conclusion

The Prototype pattern enables fast, flexible object creation through cloning. This Vim9script example shows how a registry and per-type cloning keep creation decoupled and efficient.
