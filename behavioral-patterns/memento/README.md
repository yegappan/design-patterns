# Memento Design Pattern in Vim9script

## Overview

The **Memento Pattern** is a behavioral design pattern that captures and externalizes an object's internal state so it can be restored later without exposing its implementation details.

## Intent

- Capture object state without breaking encapsulation
- Restore state at a later time
- Support undo/redo workflows
- Keep history outside the originator

## Also Known As

- Snapshot

## When to Use

Use the Memento pattern when:
- You need to restore an objectâ€™s previous state
- You want undo/redo functionality
- You want to avoid exposing internal details

## Structure

```
Originator -> Memento
Caretaker -> Memento
```

## Participants

1. **Originator**: Creates and restores mementos (`TextDocument`)
2. **Memento**: Stores state (`DocumentMemento`)
3. **Caretaker**: Keeps history (`HistoryCaretaker`)

## Implementation in Vim9script

The example uses Vim9 classes, interfaces, enums, type aliases, and abstract classes:

```vim
interface IMemento
  def Id(): number
  def Describe(): string
endinterface

class DocumentMemento implements IMemento
endclass
```

## Examples Included

### 1. Document Snapshot History
**Scenario**: A text document saves and restores its content state.

**Components**:
- Originator: `TextDocument`
- Memento: `DocumentMemento`
- Caretaker: `HistoryCaretaker`

**Usage**:
```vim
var doc = TextDocument.new('Hello')
var history = HistoryCaretaker.new()
history.Save(doc.CreateMemento(1))
```

## Running the Examples

### Source the file
```vim
:source behavioral-patterns/memento/memento_pattern.vim
```

### Run the complete demo
```vim
:call g:RunMementoPatternDemo()
```

## Key Concepts Demonstrated

1. **State Capture** in mementos
2. **Encapsulation Preserved**
3. **Caretaker History** management

## Advantages

1. **Encapsulation**: State stored without exposing internals
2. **Undo/Redo**: Easy to restore snapshots
3. **Separation of Concerns**: History management is separate

## Disadvantages

1. **Memory Cost**: Many snapshots can be large
2. **Complexity**: Extra classes for memento management

## Related Patterns

- **Command**: Often used with undo/redo
- **Prototype**: Can help with state cloning
- **Iterator**: Traverse history snapshots

## Vim9script Notes

- Interfaces define memento contract
- Enums represent document state
- Type aliases clarify snapshot identifiers

## Requirements

- Vim 9.0 or later (for Vim9script class support)
- No external dependencies

## License

MIT License - Feel free to use this for learning and teaching design patterns!

## Credits

These design pattern examples were generated by GitHub Copilot to demonstrate modern Vim9script capabilities and software design principles.

## References

For more information about the Memento pattern, visit:

- **Refactoring.Guru**: [Memento Pattern](https://refactoring.guru/design-patterns/memento)
- **Gang of Four Book**: "Design Patterns: Elements of Reusable Object-Oriented Software" by Gamma, Helm, Johnson, Vlissides - Pages 283-291
- **Wikipedia**: [Memento Pattern](https://en.wikipedia.org/wiki/Memento_pattern)
- **SourceMaking**: [Memento Design Pattern](https://sourcemaking.com/design_patterns/memento)

## Conclusion

The Memento pattern captures object state for later restoration without exposing details. This Vim9script example demonstrates a document history with modern language features.
