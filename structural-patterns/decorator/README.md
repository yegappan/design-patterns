# Decorator Design Pattern in Vim9script

## Overview

The **Decorator Pattern** is a structural design pattern that adds behavior to objects dynamically by wrapping them. It provides a flexible alternative to subclassing for extending functionality.

## Intent

- Add responsibilities to objects without modifying their code
- Compose behavior at runtime
- Keep classes small and focused
- Favor composition over inheritance

## Also Known As

- Wrapper

## When to Use

Use the Decorator pattern when:
- You want to add features to individual objects, not entire classes
- You want to combine behaviors dynamically
- Subclassing would create too many combinations
- You want to preserve the original object interface

## Structure

```
Client -> Component
           ^
           |
        Decorator -> Component
           ^
           |
   Concrete Decorators
```

## Participants

1. **Component**: Common interface (`IBeverage`, `INotifier`)
2. **Concrete Component**: Base object (`Espresso`, `BaseNotifier`)
3. **Decorator**: Wraps a component (`BeverageDecorator`, `NotifierDecorator`)
4. **Concrete Decorator**: Adds behavior (`MilkDecorator`, `EmailDecorator`)

## Implementation in Vim9script

The example uses Vim9 classes, interfaces, enums, and type aliases:

```vim
interface IBeverage
  def GetDescription(): string
  def GetCost(): float
endinterface

abstract class BeverageDecorator implements IBeverage
  var beverage: IBeverage
endclass
```

## Examples Included

### 1. Beverage Decorators
**Scenario**: Add milk, mocha, and whip to base drinks.

**Components**:
- Component: `IBeverage`
- Concrete Components: `Espresso`, `HouseBlend`
- Decorators: `MilkDecorator`, `MochaDecorator`, `WhipDecorator`

**Usage**:
```vim
var drink: IBeverage = Espresso.new(DrinkSize.Small)
drink = MilkDecorator.new(drink)
```

### 2. Notification Decorators
**Scenario**: Add email, SMS, and Slack channels to a base notifier.

**Components**:
- Component: `INotifier`
- Concrete Component: `BaseNotifier`
- Decorators: `EmailDecorator`, `SmsDecorator`, `SlackDecorator`

**Usage**:
```vim
var notifier: INotifier = BaseNotifier.new()
notifier = EmailDecorator.new(SlackDecorator.new(notifier))
```

## Running the Examples

### Source the file
```vim
:source structural-patterns/decorator/decorator_pattern.vim
```

### Run the complete demo
```vim
:call g:RunDecoratorPatternDemo()
```

## Key Concepts Demonstrated

1. **Dynamic Composition** of behavior
2. **Uniform Interface** preserved across wrappers
3. **Stacking Decorators** for feature combinations
4. **Runtime Flexibility** without subclass explosion

## Advantages

1. **Open/Closed Principle**: Extend without modification
2. **Flexible Composition**: Combine features as needed
3. **Single Responsibility**: Keep concerns in separate decorators
4. **Runtime Configurability**: Add or remove behavior dynamically

## Disadvantages

1. **Complexity**: Many small objects can be hard to track
2. **Ordering Sensitivity**: Decorator order can matter

## Related Patterns

- **Composite**: Also uses recursive composition
- **Bridge**: Separates abstraction and implementation
- **Adapter**: Changes interface rather than extending behavior

## Vim9script Notes

- Interfaces and abstract decorators keep APIs consistent
- Enums show configuration options in the examples
- Type aliases improve readability of signatures

## Requirements

- Vim 9.0 or later (for Vim9script class support)
- No external dependencies

## License

MIT License - Feel free to use this for learning and teaching design patterns!

## Credits

These design pattern examples were generated by GitHub Copilot to demonstrate modern Vim9script capabilities and software design principles.

## References

For more information about the Decorator pattern, visit:

- **Refactoring.Guru**: [Decorator Pattern](https://refactoring.guru/design-patterns/decorator)
- **Gang of Four Book**: "Design Patterns: Elements of Reusable Object-Oriented Software" by Gamma, Helm, Johnson, Vlissides - Pages 175-184
- **Wikipedia**: [Decorator Pattern](https://en.wikipedia.org/wiki/Decorator_pattern)
- **SourceMaking**: [Decorator Design Pattern](https://sourcemaking.com/design_patterns/decorator)

## Conclusion

The Decorator pattern enables flexible, runtime feature composition while preserving a stable interface. This Vim9script example demonstrates how to build and stack decorators cleanly using modern language features.
