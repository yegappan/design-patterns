# Singleton Design Pattern in Vim9script

## Overview

The **Singleton Pattern** is a creational design pattern that ensures a class has only one instance and provides a global access point to it.

## Intent

- Ensure only one instance exists
- Provide controlled global access
- Manage shared resources consistently

## Also Known As

- None

## When to Use

Use the Singleton pattern when:
- You need exactly one shared instance
- Multiple parts of the application must access the same resource
- You want lazy initialization for a shared object

## Structure

```
Client -> Singleton
```

## Participants

1. **Singleton**: The single-instance class (`ConfigurationManager`)
2. **Client**: Accesses the instance through a factory function

## Implementation in Vim9script

Vim9script uses a script-local instance and a global factory function:

```vim
var instance: MySingleton = null_object

def g:GetMySingleton(): MySingleton
  if instance == null_object
    instance = MySingleton.new()
  endif
  return instance
enddef
```

## Examples Included

### 1. Configuration Manager
**Scenario**: Centralized configuration shared across the application.

### 2. Logger
**Scenario**: Shared logging with a single history.

### 3. Database Connection
**Scenario**: One shared connection with lazy initialization.

### 4. Application State
**Scenario**: Shared authentication and session state.

**Usage**:
```vim
var config = g:GetConfigurationManager()
config.Set('theme', 'dark')
```

## Running the Examples

### Source the file
```vim
:source singleton/singleton_pattern.vim
```

### Run the complete demo
```vim
:call g:RunSingletonPatternDemo()
```

## Key Concepts Demonstrated

1. **Single Instance Guarantee** with script-local storage
2. **Global Access Point** via a factory function
3. **Lazy Initialization** on first access

## Advantages

1. **Controlled Access** to shared resources
2. **Lazy Initialization** reduces upfront work
3. **Shared State** across the application

## Disadvantages

1. **Global State** can complicate testing
2. **Hidden Dependencies** in client code
3. **Tight Coupling** to the singleton

## Related Patterns

- **Factory Method**: Often used to create the singleton
- **Abstract Factory**: Can be implemented as a singleton
- **Prototype**: Alternative when multiple instances are needed

## Vim9script Notes

- Use `null_object` to detect uninitialized instances
- Script-local variables keep the instance private
- Global functions expose the singleton to callers

## Requirements

- Vim 9.0 or later (for Vim9script class support)
- No external dependencies

## License

MIT License - Feel free to use this for learning and teaching design patterns!

## Credits

These design pattern examples were generated by GitHub Copilot to demonstrate modern Vim9script capabilities and software design principles.

## References

For more information about the Singleton pattern, visit:

- **Refactoring.Guru**: [Singleton Pattern](https://refactoring.guru/design-patterns/singleton)
- **Gang of Four Book**: "Design Patterns: Elements of Reusable Object-Oriented Software" by Gamma, Helm, Johnson, Vlissides - Pages 127-134
- **Wikipedia**: [Singleton Pattern](https://en.wikipedia.org/wiki/Singleton_pattern)
- **SourceMaking**: [Singleton Design Pattern](https://sourcemaking.com/design_patterns/singleton)

## Conclusion

The Singleton pattern provides a controlled, single instance for shared resources. This Vim9script example demonstrates lazy initialization and safe access through a global factory function.
